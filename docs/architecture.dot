digraph G {
  rankdir=TB;
  node [shape=box, style="rounded,filled", fontname="Arial", margin=0.3];
  edge [fontname="Arial"];
  
  // Client nodes
  client [label="Client Applications", fillcolor="#E1F5FE", style="filled"];
  
  // Main components
  cloud_run [label="Cloud Run\nFace Swap API", fillcolor="#A5D6A7", style="filled"];
  artifact_registry [label="Artifact Registry\nContainer Images", fillcolor="#FFF59D", style="filled"];
  cloud_storage [label="Cloud Storage\nTemporary Files", fillcolor="#FFE0B2", style="filled"];
  cloud_build [label="Cloud Build\nCI/CD Pipeline", fillcolor="#D1C4E9", style="filled"];
  cloud_monitoring [label="Cloud Monitoring\nObservability", fillcolor="#B3E5FC", style="filled"];
  
  // Models/AI components
  models [label="InsightFace Models\nONNX Runtime", fillcolor="#F8BBD0", style="filled"];
  
  // Terraform
  terraform [label="Terraform\nInfrastructure as Code", fillcolor="#C5CAE9", style="filled"];
  
  // Connections
  client -> cloud_run [label="HTTP/S"];
  cloud_run -> cloud_storage [label="Store/Retrieve"];
  cloud_run -> models [label="Inference"];
  cloud_build -> artifact_registry [label="Push Images"];
  cloud_build -> terraform [label="Apply"];
  terraform -> cloud_run [label="Deploy"];
  terraform -> cloud_storage [label="Provision"];
  artifact_registry -> cloud_run [label="Pull Image"];
  cloud_run -> cloud_monitoring [label="Metrics/Logs"];
  cloud_build -> cloud_run [label="Deploy"];
  
  // Subgraph for GCP
  subgraph cluster_gcp {
    label="Google Cloud Platform";
    style=dashed;
    cloud_run;
    artifact_registry;
    cloud_storage;
    cloud_build;
    cloud_monitoring;
  }
}
